# Submodule?
서브모듈(submodule)이란 git 저장소 안에 다른 git 저장소를 디렉토리를 분리해 넣는 것을 말한다. 모노레포(mono-repository)와는 전혀 다른 개념이다. 모노레포는 하나의 레포지토리(저장소)에 여러 프로젝트를 결합한 것이다. 이에 반해 서브모듈은 메인이 되는 깃 레포지토리 안의 특정 디렉토리에 서브 모듈의 깃 레포지토리를 포함시키는 것으로, 하나의 레포지토리 안에서 여러 레포지토리가 존재한다. 이 서브모듈은 각각 형상관리가 따로 이루어진다.
## 왜 써야하나
### 나는 왜 썼을까?
내가 진행하는 프로젝트들(예를 들어 사내 플젝이나 개인 플젝 등...)에서 공통적으로 사용하는 코드들이 존재한다. 주로 UI 컴포넌트들이 있고 일부는 유틸 함수들이다. 이걸 매번 복사, 붙여넣기 하다가 버전 관리가 되면서 쉽게 복붙이 가능했으면 좋겠다는 생각이 들었다. 찾다보니 서브모듈이라는 것이 존재한다는 것을 알게되어 적용하게 되었다.
### 다른 선택지: npm
그러면 다른 선택지도 있었다. 예를 들어 모듈화해서 아예 npm에 올리는 것. 이 경우엔 버전관리도 가능하고 아예 프로젝트로 분리해서 코드의 개발도 용이하다. 그럼에도 서브모듈을 사용한 이유는 잦은 변경이 있을 경우 서브모듈이 더 유리하기 때문이다.
### npm을 안 쓴 이유
- 과거에 npm을 통해 버전관리를 시도한 적이 있었다. 물론 그 당시엔 개발 능률이 떨어져서 범용 라이브러리 개발에 실패한 것도 이유로 작용했지만 UI로서의 기능 변경이 상당히 잦았기 때문에 하루에도 버전 업데이트가 3~5회씩 있었다. 이걸 매번 모듈에 올리고, 매번 npm에서 install 하는 것은 시간적 낭비가 심했다.
- 한 가지 이유가 더 있는데, npm으로 올리는 경우 이 모듈을 사용하는 모든 프로젝트가 하나의 코드를 사용해야한다. 이는 프로젝트 별로 커스터마이징하는 것이 극도로 어려워진다는 의미다. 물론 처음 라이브러리를 만들 때부터 커스터마이징을 무제한에 가깝게 개발하는 것도 방법이겠지만 그게 가능했으면 antd니 mui니 ui 라이브러리가 난립하지 않았겠지. 그리고 이 라이브러리는 고작 1~2명이 개발하는데 그렇게 만들려면 개발 시간이 많이 필요하다. 프로젝트를 거의 찍어내는 수준으로 만들어야 하는 내 입장에서 이건 시간 낭비다. 제일 쉬운 방법은 뭐냐면, 직전 프로젝트에서 썼던 코드를 복붙하는 것이다.
### 다시 서브모듈로 돌아와서 생각해본다면
복붙하는 것엔 장점이 있다. 복붙한 코드에 손을 대는 바보짓(물론 몇 번 이짓을 하고나서 깨달은 거지만)을 할 게 아니라면, 당연히 복붙한 코드를 오버라이딩 하는 것이 일반적이다. 그러면 자주 사용하는 코드들은 원본 코드에 남고 이 프로젝트에 최적화된 코드는 오버라이딩 된 코드에 남는다. 라이브러리를 개발하면서 프로젝트 개발이 같이 진행된다.  
이 때 직전 프로젝트에서 사용한 코드라는 것은 몇 번인지 모를 정제 과정을 거쳤다는 뜻이다. 내가 이번 프로젝트에 좀 더 쉽게 오버라이딩 할 수 있도록. 하도 많이 손봐서 너덜너덜해진 button이나 input 컴포넌트의 경우엔 거의 최소한의 기능만 남아있다. css variable로 커스터마이징도 매우 용이하고.
### 정리하자면
내 경우는 특이한 케이스라 할 수 있겠지만, 이렇다 보니 서브모듈이 내 상황에 딱 맞았다.
1. 라이브러리의 업데이트가 하루에 2~3번 꼴로 매우 잦다.
2. 극단적으로 범용적인 코드를 만들어야 하지만, 라이브러리를 따로 개발할 시간은 없다.
3. 대체로 직전에 사용한 코드를 그대로 사용한다.
# Usage
-  기존에 존재하는 프로젝트에 추가하는 경우
```shell
git submodule add https://github.com/gateisbug/parakeet.git path/to/submodule
```
- 서브모듈을 pull 받는 경우
```shell
git submodule update --init --recursive
```
- 서브모듈을 push 하는 경우
```shell
cd path/to/submodule
git add .
git commit -m "commit message"
git push origin branch-name
```
# 참고자료
- [7.11 Git 도구 - 서브모듈](https://git-scm.com/book/ko/v2/Git-도구-서브모듈)
- [Git submodule을 사용해보자](https://velog.io/@junho5336/Git-Submodule을-사용해보자)
- [실제로 적용한 내 개인 플젝](https://github.com/gateisbug/alit/tree/dev)